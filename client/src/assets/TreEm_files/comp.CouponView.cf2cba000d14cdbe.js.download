(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[99182,64778],{60042:function(n,o){var t;!function(){"use strict";var e={}.hasOwnProperty;function r(){for(var n=[],o=0;o<arguments.length;o++){var t=arguments[o];if(t){var i=typeof t;if("string"===i||"number"===i)n.push(t);else if(Array.isArray(t)){if(t.length){var u=r.apply(null,t);u&&n.push(u)}}else if("object"===i){if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]")){n.push(t.toString());continue}for(var a in t)e.call(t,a)&&t[a]&&n.push(a)}}}return n.join(" ")}n.exports?(r.default=r,n.exports=r):void 0===(t=function(){return r}.apply(o,[]))||(n.exports=t)}()},18365:function(n){var o=Math.ceil,t=Math.max;n.exports=function(n,e,r,i){for(var u=-1,a=t(o((e-n)/(r||1)),0),c=Array(a);a--;)c[i?a:++u]=n,n+=r;return c}},55294:function(n,o,t){var e=t(18365),r=t(57535),i=t(94919);n.exports=function(n){return function(o,t,u){return u&&"number"!=typeof u&&r(o,t,u)&&(t=u=void 0),o=i(o),void 0===t?(t=o,o=0):t=i(t),u=void 0===u?o<t?1:-1:i(u),e(o,t,u,n)}}},4215:function(n,o,t){var e=t(55294)();n.exports=e},31704:function(n,o,t){"use strict";t.d(o,{W7:function(){return i},kP:function(){return u}});var e=t(2294),r="B2_COUPONS",i=function(n){var o=n.params,t=n.payload;return{type:"".concat(r,"_SAVE_COUPON"),params:o,payload:t,promise:(0,e.F)({method:"POST",url:"".concat("https://api.tiki.vn","/applecat/v1/coupon/customer/save"),params:o})}},u=function(n){return{type:"".concat(r,"_CLEAR_COUPON_ERROR"),payload:n}};o.ZP=function(n){return{type:"".concat(r,"_FETCH_COUPONS"),params:n,promise:(0,e.F)({url:"".concat("https://tiki.vn/api/v2","/events/coupon/v2"),params:n})}}},6229:function(n,o,t){"use strict";t.r(o);var e=t(85034),r=t(70169),i=t(24246),u=t(28023),a=t(31704),c=t(79336),s=t(45620),d=t(11634),l=t(99729),p=t.n(l),v=t(4215),f=t.n(v),_=t(65218),h=t.n(_),g=t(27378),m=t(37254),x=t(98710),w=t(15051),C=h()((function(){return Promise.resolve().then(t.bind(t,45620))}),{loadableGenerated:{webpack:function(){return[45620]}},loading:function(){return null}}),y=function(n){var o=n.widget,t=o.payload,e=o.id,r=n.fetchCoupons,a=n.coupons,c=n.status,l=n.onScreen,p=t.codes;(0,g.useEffect)((function(){l&&r({codes:p.join(","),id:e})}),[p,r,e,l]);var v=(0,g.useMemo)((function(){var n;return null===a||void 0===a||null===(n=a.filter)||void 0===n?void 0:n.call(a,(function(n){return!(0,s.isCouponExpired)(n)}))}),[a]),_=c===x.Q_.INITIAL||c===x.Q_.REQUEST;return v.length||_?_?(0,i.jsx)(w.Q,{children:(0,i.jsx)(w.Z,{children:f()(p.length).map((function(n){return(0,i.jsx)(u.FullCoupon,{loading:!0,loadingAnimation:!1,allowFastDom:!0,className:"coupon-item"},n)}))})}):(0,i.jsx)(w.Q,{children:(0,i.jsx)(w.Z,{children:v.map((function(n,o){return(0,i.jsx)(d.y0.Provider,{initialValue:{container_id:"coupon_".concat(n.coupon_code),container_index:o,container_label:n&&n.short_title,rule_id:n.rule_id,coupon_code:n.coupon_code},children:(0,i.jsx)(C,{coupon:n})},n.coupon_id)}))})}):null};y.propTypes={};o.default=(0,m.$j)((function(n,o){var t,i;return(0,r.Z)((0,e.Z)({},p()(n,"campaign.coupons.".concat(null===o||void 0===o||null===(t=o.widget)||void 0===t?void 0:t.id),{coupons:[],status:x.Q_.INITIAL})),{user:p()(n,"desktop.app.customer",{})||{},saveCouponError:p()(n,"campaign.coupons.couponsMap.".concat(null===o||void 0===o||null===(i=o.item)||void 0===i?void 0:i.coupon_id,".error"),null)})}),{fetchCoupons:a.ZP})((function(n){var o=(0,g.useRef)(),t=(0,c.RO)(o,x.sw);return(0,i.jsx)("div",{ref:o,children:(0,i.jsx)(y,(0,r.Z)((0,e.Z)({},n),{onScreen:t}))})}))},15051:function(n,o,t){"use strict";t.d(o,{Q:function(){return c},Z:function(){return s}});var e=t(19989),r=t(98781),i=t(94822);function u(){var n=(0,e.Z)([""]);return u=function(){return n},n}function a(){var n=(0,e.Z)(["\n  display: grid;\n  flex-flow: row wrap;\n  justify-content: center;\n  padding-block: 24px;\n  column-gap: 16px;\n  row-gap: 24px;\n  grid-template-columns: 1fr 1fr;\n\n  .coupon-item {\n    width: 100%;\n  }\n"]);return a=function(){return n},n}var c=(0,i.default)(r.Z).withConfig({componentId:"sc-9aa8c7c9-0"})(u()),s=i.default.div.withConfig({componentId:"sc-9aa8c7c9-1"})(a())},45620:function(n,o,t){"use strict";t.r(o),t.d(o,{isCouponExpired:function(){return h}});var e=t(23842),r=t(85034),i=t(35230),u=t.n(i),a=t(24246),c=t(28023),s=t(31704),d=t(90583),l=t(64463),p=t(99729),v=t.n(p),f=t(27378),_=t(37254),h=function(n){var o=n.status;return 1e3*n.expired_at-Date.now()<=0||"inactive"===o},g=function(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!0===n?"L\u01b0u th\xe0nh c\xf4ng. B\u1ea1n c\xf3 th\u1ec3 xem v\xe0 s\u1eed d\u1ee5ng m\xe3 gi\u1ea3m gi\xe1 \u1edf trang Gi\u1ecf H\xe0ng":"M\xe3 gi\u1ea3m gi\xe1 ".concat(o," kh\xf4ng h\u1ee3p l\u1ec7 ")},m=function(n){return!0===n?"success":"failure"};o.default=(0,_.$j)((function(n,o){var t,e,r=n.desktop.app.webConfig;return{user:v()(n,"desktop.app.customer",{})||{},saveCouponError:v()(n,"campaign.coupons.couponsMap.".concat(null===o||void 0===o||null===(t=o.coupon)||void 0===t?void 0:t.coupon_id,".error"),null),saved:v()(n,"campaign.coupons.couponsMap.".concat(null===o||void 0===o||null===(e=o.coupon)||void 0===e?void 0:e.coupon_id,".saved"),!1)||!1,forceCouponList:v()(r,"forceContent.couponList",{})}}),(function(n){return{handleLoginModal:function(o,t,e,r){return n((0,d.MR)(o,t,e,r))},saveCoupon:function(o){return n((0,s.W7)(o))},clearSaveCouponError:function(o){return n((0,s.kP)(o))}}}))((function(n){var o=n.user,t=n.coupon,i=n.saveCoupon,s=n.saveCouponError,d=n.handleLoginModal,p=n.saved,v=n.forceCouponList,_=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(arguments.length>1?arguments[1]:void 0)return"saved";var o=n.status;return h(n)?"expired":"active"===o?"available":o}(t,p),x=(0,l.Z)(),w=v[null===t||void 0===t?void 0:t.coupon_code]?(0,r.Z)({},t,v[null===t||void 0===t?void 0:t.coupon_code]):t,C=(0,f.useCallback)((0,e.Z)(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(x({view_id:"coupon_save_btn",view_label:"L\u01b0u",view_type:"button",view_data:{coupon_code:t.coupon_code,rule_id:t.rule_id}}),"saved"!==status&&"expired"!==status&&"inactive"!==status){n.next=3;break}return n.abrupt("return");case 3:(null===o||void 0===o?void 0:o.id)?i({params:{ruleId:t.rule_id,coupon_code:t.coupon_code},payload:t}):d(!0,"login",!0,window.location.pathname);case 4:case"end":return n.stop()}}),n)}))),[t,d,i,null===o||void 0===o?void 0:o.id,x]),y=(0,f.useState)(!1),b=y[0],k=y[1],Z=(0,f.useCallback)((function(){k(!1)}),[]);return(0,f.useEffect)((function(){s&&k(!0)}),[s]),(0,f.useEffect)((function(){p&&k(!0)}),[p]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.FullCoupon,{onAction:C,couponInfo:w,status:_,className:"coupon-item",allowFastDom:!0}),(0,a.jsx)(c.Toast,{show:b,icon:m(p),type:m(p),message:g(p,null===t||void 0===t?void 0:t.coupon_code),onHide:Z})]})}))},64463:function(n,o,t){"use strict";t.d(o,{Z:function(){return _}});var e=t(85034),r=t(70169),i=t(99729),u=t.n(i),a=t(73915),c=t.n(a),s=t(48159),d=t.n(s),l=t(4339),p=t.n(l),v=t(27378),f=t(11634);var _=function(){var n=(0,v.useContext)(f.vZ),o=(0,v.useContext)(f.RL.Context),t=(0,v.useContext)(f.J9.Context),i=(0,v.useContext)(f.y0.Context);return(0,v.useCallback)((function(a,s){var l=u()(n,"queueRef");if(l.current&&l.current.push){var v=(0,r.Z)((0,e.Z)({},d()(a,["view_data","view_index"])),{content:{click_data:(0,e.Z)({},u()(a,"view_data"),u()(i,"value"),u()(o,"value"),u()(t,"value"))}});if(c()(a,"view_index")&&-1!==a.view_index&&(v.index={item:u()(a,"view_index")}),c()(s,"target")){var f=s.target.getBoundingClientRect();v.frame={width:u()(f,"width",0),height:u()(f,"height",0),x:u()(f,"x",0),y:u()(f,"y",0)}}!function(n,o,t,e){try{if(e&&n&&n.push){var r={_id:"id".concat(p()()),action_name:"".concat(o,"_automatic"),screen_class:u()(window,"location.href",""),screen_size:{width:u()(window,"innerWidth",0),height:u()(window,"innerHeight",0)},screen_data:e,created_at:(new Date).valueOf(),event_type:"".concat(o,"_automatic"),details:t};n.push(r)}}catch(i){console.error(i)}}(l.current,"click",v,(0,e.Z)({},u()(n,"value")))}}),[n,i,o,t])}}}]);